# admin-elastic-template.json

apiVersion: opensearch.opster.io/v1
kind: OpensearchIndexTemplate
metadata:
  name: admin-index-template
  annotations:
    "helm.sh/hook-weight": "18"
    "helm.sh/hook": post-install, post-upgrade
spec:
  name: admin-index-template
  opensearchCluster:
    name: {{ .Values.clustername }}
  indexPatterns:
    - "admin*"
  priority: 500
  template:
    settings:
      number_of_shards: 1
      number_of_replicas: 0
      opendistro.index_state_management.policy_id: "rollover_policy"
      plugins.index_state_management.rollover_alias: "rollover_policy"
      mapping.total_fields.limit: "2000"
    mappings:
      dynamic: "false"
      properties:
        "@timestamp":
          type: date
        started_at:
          type: long
        correlation_id:
          type: text
          fields:
            keyword:
              type: keyword
              ignore_above: 256
        route:
          properties:
            name:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            paths:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        latencies:
          properties:
            kong:
              type: long
            proxy:
              type: long
            request:
              type: long
        client_ip:
          type: text
          fields:
            keyword:
              type: keyword
              ignore_above: 256
        upstream_uri:
          type: text
          fields:
            keyword:
              type: keyword
              ignore_above: 256
        authenticated_entity:
          properties:
            id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        consumer:
          properties:
            created_at:
              type: long
            custom_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            updated_at:
              type: long
            username:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            org_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            project_name:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        request:
          properties:
            size:
              type: float
            type:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            is_db_proxy:
              type: boolean
            is_cache_only:
              type: boolean
            policy_name:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            policy_id:
              type: keyword
              ignore_above: 256
            coc_policy_name:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            coc_policy_id:
              type: keyword
              ignore_above: 256
            model_saved_name:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            model_version:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            model_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            deployment_name:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            deployment_id:
              type: keyword
              ignore_above: 256
            exit_time:
              type: float
            id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            method:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            ngx_req_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            uri:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            headers:
              properties:
                x-enkrypt-refresh-cache:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
        response:
          properties:
            status:
              type: long
            headers:
              properties:
                x-enkrypt-cache-status:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
  dataStream: {}

# ai-proxy-elastic-template.json
---
apiVersion: opensearch.opster.io/v1
kind: OpensearchIndexTemplate
metadata:
  name: ai-proxy-index-template
  annotations:
    "helm.sh/hook-weight": "18"
    "helm.sh/hook": post-install, post-upgrade
spec:
  name: ai-proxy-index-template
  opensearchCluster:
    name: {{ .Values.clustername }}
  indexPatterns:
    - "ai-proxy*"
  template:
    settings:
      number_of_shards: 1
      number_of_replicas: 0
      opendistro.index_state_management.policy_id: "rollover_policy"
      plugins.index_state_management.rollover_alias: "rollover_policy"
      mapping.total_fields.limit: "2000"
    mappings:
      dynamic: "false"
      properties:
        "@timestamp":
          type: date
        started_at:
          type: long
        correlation_id:
          type: text
          fields:
            keyword:
              type: keyword
              ignore_above: 256
        route:
          properties:
            name:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            paths:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        latencies:
          properties:
            kong:
              type: long
            proxy:
              type: long
            request:
              type: long
        client_ip:
          type: text
          fields:
            keyword:
              type: keyword
              ignore_above: 256
        upstream_uri:
          type: text
          fields:
            keyword:
              type: keyword
              ignore_above: 256
        authenticated_entity:
          properties:
            id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        consumer:
          properties:
            created_at:
              type: long
            custom_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            updated_at:
              type: long
            username:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            org_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            project_name:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        ai:
          properties:
            proxy:
              properties:
                usage:
                  properties:
                    prompt_tokens:
                      type: long
                    cost:
                      type: long
                    time_per_token:
                      type: long
                    total_tokens:
                      type: long
                    completion_tokens:
                      type: long
        request:
          properties:
            type:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            is_playground:
              type: boolean
            exit_time:
              type: float
            id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            method:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            ngx_req_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            headers:
              properties:
                x-enkrypt-deployment:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
                x-enkrypt-refresh-cache:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
            enkrypt:
              properties:
                tags:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
                context:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
                body:
                  properties:
                    model:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    stream:
                      type: boolean
                input_guardrails:
                  properties:
                    is_req_blocked:
                      type: boolean
                    is_pii_redacted:
                      type: boolean
                    enabled_detectors:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    detected_detectors:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    blocked_detectors:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    detect_response:
                      properties:
                        summary:
                          properties:
                            system_prompt_similarity:
                              type: long
                            policy_violation:
                              type: long
                            bias:
                              type: long
                            copyright_ip:
                              type: long
                            on_topic:
                              type: long
                            nsfw:
                              type: long
                            injection_attack:
                              type: long
                            keyword_detected:
                              type: long
                            pii:
                              type: long
                            toxicity:
                              type: text
                              fields:
                                keyword:
                                  type: keyword
                                  ignore_above: 256
                            sponge_attack:
                              type: long
                        key:
                          type: text
                          fields:
                            keyword:
                              type: keyword
                              null_value: "NULL"
                              ignore_above: 256
                    policy:
                      properties:
                        policy_id:
                          type: long
                        detectors:
                          properties:
                            system_prompt:
                              properties:
                                enabled:
                                  type: boolean
                                index:
                                  type: text
                                  fields:
                                    keyword:
                                      type: keyword
                                      ignore_above: 256
                            policy_violation:
                              properties:
                                enabled:
                                  type: boolean
                            bias:
                              properties:
                                enabled:
                                  type: boolean
                            copyright_ip:
                              properties:
                                enabled:
                                  type: boolean
                            topic_detector:
                              properties:
                                enabled:
                                  type: boolean
                                topic:
                                  type: text
                                  fields:
                                    keyword:
                                      type: keyword
                                      ignore_above: 256
                            nsfw:
                              properties:
                                enabled:
                                  type: boolean
                            toxicity:
                              properties:
                                enabled:
                                  type: boolean
                            pii:
                              properties:
                                enabled:
                                  type: boolean
                                entities:
                                  type: text
                                  fields:
                                    keyword:
                                      type: keyword
                                      ignore_above: 256
                            injection_attack:
                              properties:
                                enabled:
                                  type: boolean
                            keyword_detector:
                              properties:
                                enabled:
                                  type: boolean
                                banned_keywords:
                                  type: text
                                  fields:
                                    keyword:
                                      type: keyword
                                      ignore_above: 256
                            sponge_attack:
                              properties:
                                enabled:
                                  type: boolean
                model:
                  properties:
                    model_name:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    testing_for:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    model_id:
                      type: long
                    model_config:
                      properties:
                        hosting_type:
                          type: text
                          fields:
                            keyword:
                              type: keyword
                              ignore_above: 256
                        model_provider:
                          type: text
                          fields:
                            keyword:
                              type: keyword
                              ignore_above: 256
                deployment:
                  properties:
                    name:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    deployment_id:
                      type: long
                    model_saved_name:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    model_version:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    input_guardrails_policy:
                      properties:
                        enabled:
                          type: boolean
                        policy_name:
                          type: text
                          fields:
                            keyword:
                              type: keyword
                              ignore_above: 256
                        block:
                          type: text
                          fields:
                            keyword:
                              type: keyword
                              ignore_above: 256
                        additional_config:
                          properties:
                            pii_redaction:
                              type: boolean
                    output_guardrails_policy:
                      properties:
                        enabled:
                          type: boolean
                        policy_name:
                          type: text
                          fields:
                            keyword:
                              type: keyword
                              ignore_above: 256
                        block:
                          type: text
                          fields:
                            keyword:
                              type: keyword
                              ignore_above: 256
                        additional_config:
                          properties:
                            hallucination:
                              type: boolean
                            adherence:
                              type: boolean
                            relevancy:
                              type: boolean
        response:
          properties:
            status:
              type: long
            headers:
              properties:
                x-kong-llm-model:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
                content-encoding:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
            enkrypt:
              properties:
                metrics:
                  properties:
                    input_guardrails_latency:
                      type: float
                    output_guardrails_latency:
                      type: float
                    endpoint_latency:
                      type: float
                output_guardrails:
                  properties:
                    is_res_blocked:
                      type: boolean
                    is_pii_unredacted:
                      type: boolean
                    enabled_detectors:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    detected_detectors:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    blocked_detectors:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    skipped_detectors:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    relevancy_response:
                      properties:
                        summary:
                          properties:
                            relevancy_score:
                              type: long
                    hallucination_response:
                      properties:
                        summary:
                          properties:
                            is_hallucination:
                              type: boolean
                    adherence_response:
                      properties:
                        summary:
                          properties:
                            adherence_score:
                              type: long
                    detect_response:
                      properties:
                        summary:
                          properties:
                            system_prompt_similarity:
                              type: long
                            policy_violation:
                              type: long
                            bias:
                              type: long
                            copyright_ip:
                              type: long
                            on_topic:
                              type: long
                            nsfw:
                              type: long
                            injection_attack:
                              type: long
                            keyword_detected:
                              type: long
                            pii:
                              type: long
                            toxicity:
                              type: text
                              fields:
                                keyword:
                                  type: keyword
                                  ignore_above: 256
                            sponge_attack:
                              type: long
                        key:
                          type: text
                          fields:
                            keyword:
                              type: keyword
                              null_value: "NULL"
                              ignore_above: 256
                    policy:
                      properties:
                        policy_id:
                          type: long
                        detectors:
                          properties:
                            system_prompt:
                              properties:
                                enabled:
                                  type: boolean
                                index:
                                  type: text
                                  fields:
                                    keyword:
                                      type: keyword
                                      ignore_above: 256
                            policy_violation:
                              properties:
                                enabled:
                                  type: boolean
                            bias:
                              properties:
                                enabled:
                                  type: boolean
                            copyright_ip:
                              properties:
                                enabled:
                                  type: boolean
                            topic_detector:
                              properties:
                                enabled:
                                  type: boolean
                                topic:
                                  type: text
                                  fields:
                                    keyword:
                                      type: keyword
                                      ignore_above: 256
                            nsfw:
                              properties:
                                enabled:
                                  type: boolean
                            toxicity:
                              properties:
                                enabled:
                                  type: boolean
                            pii:
                              properties:
                                enabled:
                                  type: boolean
                                entities:
                                  type: text
                                  fields:
                                    keyword:
                                      type: keyword
                                      ignore_above: 256
                            injection_attack:
                              properties:
                                enabled:
                                  type: boolean
                            keyword_detector:
                              properties:
                                enabled:
                                  type: boolean
                                banned_keywords:
                                  type: text
                                  fields:
                                    keyword:
                                      type: keyword
                                      ignore_above: 256
                            sponge_attack:
                              properties:
                                enabled:
                                  type: boolean
  dataStream: {}

# guardrails-elastic-template.json
---
apiVersion: opensearch.opster.io/v1
kind: OpensearchIndexTemplate
metadata:
  name: guardrails-index-template
  annotations:
    "helm.sh/hook-weight": "18"
    "helm.sh/hook": post-install, post-upgrade 
spec:
  name: guardrails-index-template
  opensearchCluster:
    name: {{ .Values.clustername }}
  indexPatterns:
    - "guardrails*"
  template:
    settings:
      number_of_shards: 1
      number_of_replicas: 0
      opendistro.index_state_management.policy_id: "rollover_policy"
      plugins.index_state_management.rollover_alias: "rollover_policy"
      mapping.total_fields.limit: "2000"
    mappings:
      dynamic: "false"
      properties:
        "@timestamp":
          type: date
        started_at:
          type: long
        correlation_id:
          type: text
          fields:
            keyword:
              type: keyword
              ignore_above: 256
        route:
          properties:
            name:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            paths:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        latencies:
          properties:
            kong:
              type: long
            proxy:
              type: long
            request:
              type: long
        client_ip:
          type: text
          fields:
            keyword:
              type: keyword
              ignore_above: 256
        upstream_uri:
          type: text
          fields:
            keyword:
              type: keyword
              ignore_above: 256
        authenticated_entity:
          properties:
            id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        consumer:
          properties:
            created_at:
              type: long
            custom_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            updated_at:
              type: long
            username:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            org_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            project_name:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        request:
          properties:
            type:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            is_playground:
              type: boolean
            exit_time:
              type: float
            id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            method:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            ngx_req_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            policy_id:
              type: keyword
              ignore_above: 256
            coc_policy_id:
              type: long
            headers:
              properties:
                x-enkrypt-policy:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
                x-enkrypt-refresh-cache:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
            body:
              properties:
                entities:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
                detectors:
                  properties:
                    system_prompt:
                      properties:
                        enabled:
                          type: boolean
                        index:
                          type: text
                          fields:
                            keyword:
                              type: keyword
                              ignore_above: 256
                    policy_violation:
                      properties:
                        enabled:
                          type: boolean
                    bias:
                      properties:
                        enabled:
                          type: boolean
                    copyright_ip:
                      properties:
                        enabled:
                          type: boolean
                    topic_detector:
                      properties:
                        enabled:
                          type: boolean
                        topic:
                          type: text
                          fields:
                            keyword:
                              type: keyword
                              ignore_above: 256
                    nsfw:
                      properties:
                        enabled:
                          type: boolean
                    toxicity:
                      properties:
                        enabled:
                          type: boolean
                    pii:
                      properties:
                        enabled:
                          type: boolean
                        entities:
                          type: text
                          fields:
                            keyword:
                              type: keyword
                              ignore_above: 256
                    injection_attack:
                      properties:
                        enabled:
                          type: boolean
                    keyword_detector:
                      properties:
                        enabled:
                          type: boolean
                        banned_keywords:
                          type: text
                          fields:
                            keyword:
                              type: keyword
                              ignore_above: 256
                    sponge_attack:
                      properties:
                        enabled:
                          type: boolean
        response:
          properties:
            status:
              type: long
            headers:
              properties:
                x-enkrypt-cache-status:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
                x-enkrypt-usage-exceeded:
                  type: keyword
                  ignore_above: 256
                x-enkrypt-ratelimit-setting:
                  type: keyword
                  ignore_above: 256
                x-enkrypt-ratelimit-identifier:
                  type: keyword
                  ignore_above: 256
            body:
              properties:
                summary:
                  properties:
                    system_prompt_similarity:
                      type: long
                    policy_violation:
                      type: long
                    bias:
                      type: long
                    copyright_ip_similarity:
                      type: long
                    adherence_score:
                      type: long
                    relevancy_score:
                      type: long
                    on_topic:
                      type: long
                    nsfw:
                      type: long
                    injection_attack:
                      type: long
                    keyword_detected:
                      type: long
                    pii:
                      type: long
                    toxicity:
                      type: text
                      fields:
                        keyword:
                          type: keyword
                          ignore_above: 256
                    is_hallucination:
                      type: boolean
                    sponge_attack:
                      type: long
                key:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      null_value: "NULL"
                      ignore_above: 256
  dataStream: {}

# leaderboard-elastic-template.json
---
apiVersion: opensearch.opster.io/v1
kind: OpensearchIndexTemplate
metadata:
  name: leaderboard-index-template
  annotations:
    "helm.sh/hook-weight": "18"
    "helm.sh/hook": post-install, post-upgrade
spec:
  name: leaderboard-index-template
  opensearchCluster:
    name: {{ .Values.clustername }}
  indexPatterns:
    - "leaderboard"
  template:
    settings:
      number_of_shards: 1
      number_of_replicas: 0
      opendistro.index_state_management.policy_id: "rollover_policy"
      plugins.index_state_management.rollover_alias: "rollover_policy"
      mapping.total_fields.limit: "2000"
    mappings:
      dynamic: "false"
      properties:
        "@timestamp":
          type: date
        started_at:
          type: long
        correlation_id:
          type: text
          fields:
            keyword:
              type: keyword
              ignore_above: 256
        route:
          properties:
            name:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            paths:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        latencies:
          properties:
            kong:
              type: long
            proxy:
              type: long
            request:
              type: long
        client_ip:
          type: text
          fields:
            keyword:
              type: keyword
              ignore_above: 256
        upstream_uri:
          type: text
          fields:
            keyword:
              type: keyword
              ignore_above: 256
        authenticated_entity:
          properties:
            id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        consumer:
          properties:
            created_at:
              type: long
            custom_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            updated_at:
              type: long
            username:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            org_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            project_name:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        request:
          properties:
            is_public:
              type: boolean
            type:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            model:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            risk_type:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            sub_type:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            exit_time:
              type: float
            id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            method:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
            ngx_req_id:
              type: text
              fields:
                keyword:
                  type: keyword
                  ignore_above: 256
        response:
          properties:
            status:
              type: long
            headers:
              properties:
                x-enkrypt-cache-status:
                  type: text
                  fields:
                    keyword:
                      type: keyword
                      ignore_above: 256
  dataStream: {}
---
apiVersion: opensearch.opster.io/v1
kind: OpensearchIndexTemplate
metadata:
  annotations:
    helm.sh/hook: post-install, post-upgrade
    helm.sh/hook-weight: "18"
  name: red-teaming-template
spec:
  indexPatterns:
  - red_teaming*
  name: red_teaming_template
  opensearchCluster:
    name: enkryptai-opensearch
  template:
    mappings:
      dynamic: "false"
      dynamic_templates:
      - attack_method_params:
          path_match: request.body.redteam_test_configurations.*.attack_methods.*.*.params
          mapping:
            type: flat_object
      - attack_method_names:
          path_match: request.body.redteam_test_configurations.*.attack_methods.*.*
          match_pattern: regex
          unmatch: ^params$
          mapping:
            type: text
            fields:
              keyword:
                type: keyword
                ignore_above: 256
      properties:
        '@timestamp':
          type: date
        authenticated_entity:
          properties:
            id:
              type: keyword
        client_ip:
          type: keyword
        consumer:
          properties:
            created_at:
              type: long
            custom_id:
              type: keyword
            id:
              type: keyword
            org_id:
              type: keyword
            project_name:
              type: keyword
            updated_at:
              type: long
            username:
              type: keyword
        correlation_id:
          type: keyword
        latencies:
          properties:
            kong:
              type: long
            proxy:
              type: long
            request:
              type: long
        request:
          properties:
            body:
              properties:
                attacks:
                  type: keyword
                metadata:
                  properties:
                    email_id:
                      type: keyword
                    user_id:
                      type: keyword
                redteam_test_configurations:
                  properties:
                    access_control_and_permissions_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    access_control_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    adv_bias_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    adv_command_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    adv_competitor_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    adv_info_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    adv_pii_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    adv_tool_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    agent_behaviour_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    agent_output_quality_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    alignment_and_governance_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    bias:
                      properties:
                        sample_percentage:
                          type: long
                        test_methods:
                          type: keyword
                    bias_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    cbrn_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    competitor_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        competitors_list:
                          type: keyword
                        sample_percentage:
                          type: long
                    copyright_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    custom_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    governance_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    hallucination:
                      properties:
                        sample_percentage:
                          type: long
                        test_methods:
                          type: keyword
                    harmful_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    human_factors_and_societal_impact_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    infrastructure_and_integration_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    input_and_content_integrity_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    insecure_code_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    jailbreak:
                      properties:
                        sample_percentage:
                          type: long
                        test_methods:
                          type: keyword
                    malware:
                      properties:
                        sample_percentage:
                          type: long
                        test_methods:
                          type: keyword
                    misinformation_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    physical_and_actuation_safety_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    pii_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    privacy_attack:
                      properties:
                        sample_percentage:
                          type: long
                        test_methods:
                          type: keyword
                    privacy_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    reliability_and_monitoring_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    reliability_and_observability_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    security_and_privacy_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    sponge_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    system_prompt_extractions_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    tool_extraction_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    tool_misuse_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    toxicity:
                      properties:
                        sample_percentage:
                          type: long
                        test_methods:
                          type: keyword
                    toxicity_test:
                      properties:
                        attack_methods:
                          type: object
                          enabled: true
                        sample_percentage:
                          type: long
                    toxicityexploitation:
                      properties:
                        sample_percentage:
                          type: long
                        test_methods:
                          type: keyword
                target_model_configuration:
                  properties:
                    metadata:
                      properties:
                        enkryptai:
                          properties:
                            deployment_name:
                              type: keyword
                            project:
                              type: keyword
                    model_name:
                      type: keyword
                    model_provider:
                      type: keyword
                    testing_for:
                      type: keyword
            coc_policy_id:
              type: long
            deployment_id:
              type: long
            exit_time:
              type: float
            id:
              type: keyword
            is_playground:
              type: boolean
            is_public:
              type: boolean
            method:
              type: keyword
            model_id:
              type: long
            ngx_req_id:
              type: keyword
            type:
              type: keyword
        response:
          properties:
            body:
              properties:
                iterative:
                  properties:
                    success:
                      type: long
                multi_turn:
                  properties:
                    success:
                      type: long
                single_shot:
                  properties:
                    success:
                      type: long
                task_id:
                  type: keyword
            status:
              type: long
        route:
          properties:
            name:
              type: keyword
            paths:
              type: keyword
        started_at:
          type: long
        upstream_uri:
          type: keyword
    settings:
      number_of_shards: 1
      number_of_replicas: 0
      "index.mapping.total_fields.limit": 3000
